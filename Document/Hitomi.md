# 히토미 데이터 동기화

`hitomi.la`의 데이터 저장방식이 바뀌어 더이상 기존의 방법으로 데이터를 동기화할 수 없습니다.

`a`부터 `zzzzz...`까지의 `sha256`을 구한 `suffix-tree`를 사용해 검색을 수행합니다.
이때 키는 해시값의 앞 네 자리입니다. `galleries.1549796337.index`와 같은 파일이 생성됩니다.
또한 자주쓰이는 태그는 캐싱된 데이터 `female_sole_female-all.nozomi`등을 이용해 검색됩니다.
기존의 검색방식과는 다르게 각 선행토큰에 대한 검색결과에 대한 검색을 수행하므로 데이터 베이스를 필요로하지 않습니다.
최신 데이터는 `https://ltn.hitomi.la/index-all.nozomi`에서 `magic`을 얻을 수 있으나, 정보는 얻을 수 없습니다.

현재 유일한 해결방법은 `galleryblock`을 이용한 완전탐색 방법인 것 같습니다.

## 수동으로 데이터 동기화

`Ctrl + T`를 눌러 `Console`을 띄운뒤 다음 명령어를 입력합니다.

```
hitomi -latest
```

그러면 다음과 같은 결과가 표시됩니다.

```
1362827
636854086200000000
2019-02-10 오후 3:17:00
```

첫 번째 줄은 가장 큰 `magic`이며, 두 번째 줄과 세 번째 줄은 컴퓨터 시간대에 대한 시간입니다.

```
run gbt
```

`gbt(Gallery Block Tester)`는 지정된 범위의 `galleryblock`을 탐색합니다.

`시작`부분엔 위에서 얻은 `magic`을 입력하고, `끝` 부분엔 `magic+3000`와 같이 적당히 큰 숫자를 입력합니다.
그 다음 `시작`버튼을 눌러 완전탐색을 시작합니다.
탐색 완료후 `합치기`를 눌러 기존의 `hiddendata.json`과 합칠 수 있습니다.
`합치기` 과정이 수행되지 않으면 데이터가 동기화되지 않습니다.
모든 과정을 마친 후 프로그램을 재실행해주세요.